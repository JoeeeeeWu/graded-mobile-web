function LoadPages(){this.bImgLoad=!1,this.bTime=!1,this.picList=$(".picList"),this.oWelcomePage=$("#welcome"),this.init(),this.bind()}function Carousel(t){this.oTab=$("#"+t),this.oList=this.oTab.find(".picList"),this.aNav=this.oTab.find("nav").children(),this.iNow=0,this.iX=0,this.iW=document.documentElement.clientWidth,this.iStartTouchX=0,this.iStartX=0,this.oTimer=null,this.init(),this.bind()}function Score(){this.arr=["好失望","没有想象的那么好","很一般","良好","棒极了"],this.oScore=$("#score"),this.aLi=this.oScore.find("li"),this.setScore()}function Info(t,i){this.obj=t,this.str=i,this.init()}function NextPage(){this.bScore=!1,this.bTag=!1,this.oIndex=$("#index"),this.oScore=$("#score"),this.oTag=$("#indexTag"),this.aTagInput=this.oTag.find("input"),this.aScoreInput=this.oScore.find("input"),this.oInfo=this.oIndex.find(".info"),this.oBtn=this.oIndex.find(".btn"),this.oMask=$("#mask"),this.oNews=$("#news"),this.bind()}function News(){this.oNews=$("#news"),this.oForm=$("#form"),this.oInfo=this.oNews.find(".info"),this.aInput=this.oNews.find("input"),this.bind()}function Form(){this.oOver=$("#over"),this.oForm=$("#form"),this.oBtn=this.oForm.find(".btn"),this.aFormTag=$("#formTag").find("label"),this.isTag=!1,this.bind()}function Reset(){this.oOver=$("#over"),this.oBtn=this.oOver.find(".btn"),this.clickBtn()}LoadPages.prototype.isImgLoad=function(){for(var t=this,i=["image/1.jpg","image/2.jpg","image/3.jpg","image/4.jpg","image/5.jpg"],o=0;o<i.length;o++)!function(){var e=new Image;e.src=i[o],e.onload=function(){t.picList.html(function(t,i){return i+'<li><img src="'+e.src+'" alt="poster"></li>'}),(o=i.length-1)&&(t.bImgLoad=!0)}}(o)},LoadPages.prototype.isTimeout=function(){var t=this,i=(new Date).getTime(),o=setInterval(function(){(new Date).getTime()-i>=3500&&(t.bTime=!0),t.bImgLoad&&t.bTime&&(clearInterval(o),t.oWelcomePage.animate({opacity:0},500,"ease-in"),Carousel.bExist||(new Carousel("tabPic"),Carousel.bExist=!0),Score.bExist=!1,Score.bExist||(new Score,Score.bExist=!0),NextPage.isExist=!1,NextPage.isExist||(new NextPage,NextPage.isExist=!0))},1e3)},LoadPages.prototype.bind=function(){this.oWelcomePage.on("webkitTransitionEnd",function(){this.oWelcomePage.removeClass("pageShow")}.bind(this)),this.oWelcomePage.on("transitionend",function(){this.oWelcomePage.removeClass("pageShow")}.bind(this))},LoadPages.prototype.init=function(){this.isImgLoad(),this.isTimeout()},new LoadPages,Carousel.bExist=!1,Carousel.prototype.autoPlay=function(){var t=this;this.oTimer=setInterval(function(){t.iNow++,t.iNow=t.iNow%t.aNav.length,t.switchImg()},2e3)},Carousel.prototype.switchImg=function(){this.iX=-this.iNow*this.iW,this.oList.animate({transform:"translateX("+this.iX+"px)"},500,"ease-in");for(var t=0;t<this.aNav.length;t++)this.aNav.eq(t).removeClass("active");this.aNav.eq(this.iNow).addClass("active")},Carousel.prototype.start=function(t){t=t.changedTouches[0],this.iStartTouchX=t.pageX,this.iStartX=this.iX,clearInterval(this.oTimer)},Carousel.prototype.move=function(t){t=t.changedTouches[0];var i=t.pageX-this.iStartTouchX;this.iX=this.iStartX+i,this.oList.animate({transform:"translateX("+this.iX+"px)"},0)},Carousel.prototype.end=function(t){this.iNow=-Math.round(this.iX/this.iW),this.iNow<0&&(this.iNow=0),this.iNow>this.aNav.length-1&&(this.iNow=this.aNav.length-1),this.iNow=this.iNow%this.aNav.length,this.switchImg(),this.autoPlay()},Carousel.prototype.init=function(){this.autoPlay()},Carousel.prototype.bind=function(){this.oTab.on({touchstart:this.start.bind(this),touchmove:this.move.bind(this),touchend:this.end.bind(this)})},Score.prototype.setScore=function(){for(var t=0;t<this.aLi.length;t++)this.setStar(this.aLi.eq(t))},Score.prototype.setStar=function(t){for(var i=this,o=t.find("a"),e=t.find("input"),s=0;s<o.length;s++)o.eq(s).on("touchstart",function(){for(var t=0;t<o.length;t++)t<=$(this).index()?o.eq(t).addClass("active"):o.eq(t).removeClass("active");e.val(i.arr[$(this).index()])})},Info.prototype.showInfo=function(){this.obj.html(this.str),this.obj.animate({transform:"scale(1)",opacity:1},500,"ease-out")},Info.prototype.hideInfo=function(){var t=this;setTimeout(function(){t.obj.animate({transform:"scale(0)",opacity:0},500,"ease-in")},1500)},Info.prototype.init=function(){this.showInfo(),this.hideInfo()},NextPage.prototype.shouldSwitch=function(){this.bScore=this.isScoreChecked(),this.bTag=this.isTag(),this.bScore?this.bTag?this.turnPage():new Info(this.oInfo,"给景区添加标签"):new Info(this.oInfo,"给景区评分")},NextPage.prototype.isScoreChecked=function(){for(var t=0;t<this.aScoreInput.length;t++)if(0==this.aScoreInput.eq(t).val())return!1;return!0},NextPage.prototype.isTag=function(){for(var t=0;t<this.aTagInput.length;t++)if(this.aTagInput.eq(t).prop("checked"))return!0;return!1},NextPage.prototype.bind=function(){this.oBtn.on("tap",this.shouldSwitch.bind(this))},NextPage.prototype.turnPage=function(){var t=this;this.oMask.addClass("pageShow"),this.oNews.addClass("pageShow"),setTimeout(function(){t.oMask.animate({opacity:1},500),t.oIndex.animate({filter:"blur(5px)"},500)},20),setTimeout(function(){t.oMask.animate({opacity:0},500),t.oIndex.animate({filter:"blur(0)"},500),t.oNews.animate({opacity:1}),t.oMask.removeClass("pageShow")},3e3),News.isExist||(new News,News.isExist=!0)},News.isExist=!1,News.prototype.bind=function(){var t=this;this.aInput.eq(0).on("change",function(){"video"==this.files[0].type.split("/")[0]?(t.turnPage(),this.value=""):new Info(t.oInfo,"请上传视频！")}),this.aInput.eq(1).on("change",function(){"image"==this.files[0].type.split("/")[0]?(t.turnPage(),this.value=""):new Info(t.oInfo,"请上传图片！")})},News.prototype.turnPage=function(){this.oForm.addClass("pageShow"),this.oNews.animate({opacity:0}),this.oNews.removeClass("pageShow"),Form.isExist||(new Form,Form.isExist=!0)},Form.isExist=!1,Form.prototype.touchTag=function(){for(var t=this,i=0;i<this.aFormTag.length;i++)this.aFormTag.eq(i).on("tap",function(){t.isTag=!0,t.oBtn.addClass("submit")})},Form.prototype.touchBtn=function(){var t=this;this.oBtn.on("tap",function(){if(t.isTag){for(var i=0;i<t.aFormTag.length;i++)t.aFormTag.eq(i).find("input").prop("checked",!1);t.isTag=!1,t.oOver.addClass("pageShow"),t.oForm.removeClass("pageShow"),t.oBtn.removeClass("submit"),Reset.isExist||(new Reset,Reset.isExist=!0)}})},Form.prototype.bind=function(){this.touchTag(),this.touchBtn()},Reset.isExist=!1,Reset.prototype.clickBtn=function(){var t=this;this.oBtn.on("tap",function(){t.oOver.removeClass("pageShow")})};